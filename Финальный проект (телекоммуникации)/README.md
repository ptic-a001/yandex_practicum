# Описание проекта. 
Оператор "Ниединогоразрыва.ком" хочет предсказывать, когда пользователи планируют уходить, чтобы предложить им промокоды и специальные условия для удержания. В рамках проекта представлены данные клиентов, информация о тарифах и договорах.
# Цели проекта:

Прогнозирование оттока клиентов:
- Целью проекта является разработка ML-модели , которая будет прогнозировать отток клиентов оператора связи "Ниединогоразрыва.ком".
- Улучшение клиентского опыта

# Задачи проекта:
 1. Подготовка данных
 2. Исследовательский анализ данных
 3. Создание модели прогнозирования оттока
 4. Оценка и выбор лучшей модели
 5. Выводы по результатам + разработка стратегий удержания клиентов 

 # Отчет: Прогнозирование оттока клиентов телеком-компании
 Подготовка данных:
- Изменены типы столбцов на подходящие.
- Заменены значения 'No' в столбце end_date на NaT.
- выведена вся основная информация о датафреймах до склейки


Исследовательский анализ данных:  
- Сделано объединение датафреймов и выделение тестовой выборки.
- Обнаружены пропущенные значения после объединения данных и принято решение оставить их .
- Выполнена визуализация распределения категориальных признаков.
- Построена визуализация распределения сгруппированных данных по таргету и анализ факторов, влияющих на уход клиентов.
- Построен pairplot для анализа взаимосвязи между ежемесячными и общими тратами.   
- Добавлены дополнительные признаки, такие как группировки услуг и типов подписок.
 - Группа 1 "активных" пользователей, которые одновременно пользуются онлайн-безопасностью, резервным копированием, защитой устройств и технической поддержкой, имеет  дисбаланс и высокий процент ухода (более 20%). Они обладают неким трендом к нахождению на границах диаграммы рассеяния
 - Группа 2 пользователей, которые одновременно пользуются стриминговыми сервисами, также имеет сильный дисбаланс и высокий процент ухода (более 20%). Возможно, эти пользователи ищут лучшие условия либо не устраивает цена.
 - Группа 3 пользователей, которые одновременно пользуются стриминговыми сервисами и 'несколькими' линиями, имеет высокий процент ухода, близкий к 30%. Они также платят больше ежемесячно и имеют примерно равномерное распределение по общим затратам в пределах 95-105 .
 - Группа 4 группа клиентов с длительной подпиской (год/два), не являющихся пенсионерами и с наличием партнера. Эта группа похожа на тех, кто в нее не попал. 
 - Группа клиентов с годовыми/двухгодовыми подписками, являющимися пенсионерами и с наличием партнера, также имеет высокий процент  ухода (около 30%).
 - Создан признак duration, отражающий время пользования услугами.
 - Применены логарифмическое и бокс-кокс преобразование некоторых числовых признаков.
 - До 2017 года был небольшой спад подключения услуг, после чего начался рост. Количество пользователей, прекративших пользоваться услугами, плавно росло, но это логично, так как все больше людей подключалось. Аномальных уходов не выявлено.
  
Был получен примерный портрет уходящего клиента: 

**Уходящий клиент:**  

- Не пользуется набором услуг, такими как онлайн-безопасность, резервное копирование, защита устройств и техническая поддержка.
- Использует стриминговые сервисы.
- Возможно, также пользуется множественными линиями.
- Большие ежемесячные траты .
- У клиента длительная подписка на услуги (год/два).
- Не является пенсионером.
- Есть партнер.  
Также уходящий клиент может быть в группе с длительной подпиской (год/два), является пенсионером и имеет партнера.

**Создание модели прогнозирования оттока:**  
Логистическая регрессия:
- На валидации модель логистической регрессии достигла точности 0.8187.

Случайный лес:
- На валидации модель случайного леса достигла лучшего результата с точностью 0.8574.

LGBM:
- Модель LGBM показала наивысший показатель roc_auc (0.908) на валидации. Было решено выбрать модель LGBM с наилучшими гиперпараметрами для дальнейших тестов.
  
  
Далее, модель LGBM была протестирована на тестовых данных, где она показала значение roc_auc равное 0.907.  
  
Результаты тестирования модели LGBM:  
  
97.7% - модель правильно предсказала, что клиент не уйдет.   
2.3% - модель неправильно предсказала, что клиент уйдет, хотя он на самом деле остается.  
45.2% - модель неправильно предсказала, что клиент остается, хотя он на самом деле уходит.  
54.8% - модель правильно предсказала, что клиент уйдет.  
Точность модели(accuracy) составила 0.908, т.е. модель верно классифицирует около 90.8% клиентов.  
  
модель ошибается в том что клиент остается, хотя он на самом деле уходит, но в целом показывает хороший результат. 

